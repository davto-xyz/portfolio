---
import { getCollection } from 'astro:content';
import Title from './Title.astro';

// Obtener todas las skills desde MDX
const allSkills = await getCollection('skills');

// Definir orden de categorías para hard skills
const categoryOrder = ['frontend', 'backend', 'database', 'devops', 'tools'];

// Separar hard skills y soft skills
const hardSkills = allSkills
  .filter(category => category.data.category !== 'softskills')
  .flatMap(category => 
    category.data.skills?.map(skill => ({ 
      ...skill, 
      category: category.data.category,
      categoryOrder: categoryOrder.indexOf(category.data.category)
    })) || []
  ).sort((a, b) => {
    // Solo ordenar por categoría según el orden definido
    return a.categoryOrder - b.categoryOrder;
  });

const softSkillsData = allSkills.find(category => category.data.category === 'softskills');
const softSkills = softSkillsData?.data.skills || [];
---

<section class="bg-[#E3E2DC] py-20 min-h-screen flex items-center" id="skills">
  <div class="w-full ">
    
    <!-- Header -->
    <div class="mb-12 text-center">
      <Title title='Habilidades'></Title>
      <div class="text-2xl text-gray-800  font-stretch-expanded tracking-tighter mt-6 leading-relaxed">Hard skills</div>
    </div>

    <!-- Skills Row -->
       
    <div class="flex flex-wrap lg:justify-center justify-between items-center gap-8 lg:gap-4 sm:gap-6 md:gap-8 lg:max-w-5xl lg:mx-auto w-full">
    
      {hardSkills.map((skill) => (
        <div class="relative flex items-center justify-center p-6 rounded-full bg-transparent border-gray-950 border-3 hover:border-gold-500 transition-all duration-300 hover:scale-110 shadow-lg hover:shadow-xl group">
          <div class="w-9 h-9 sm:w-14 sm:h-14 md:w-12 md:h-12 flex items-center justify-center">
            {skill.iconType === 'url' ? (
              <img 
                src={skill.icon} 
                alt={`${skill.name} technology`}
                class="w-full h-full object-contain"
              />
            ) : (
              <span class="text-2xl sm:text-3xl md:text-4xl">{skill.icon}</span>
            )}
          </div>
          
          <!-- Custom Tooltip -->
          <div class="absolute bottom-full left-1/2 transform -translate-x-1/2 mb-2 px-3 py-1 bg-gray-900 text-white text-sm rounded-lg opacity-0 group-hover:opacity-100 transition-opacity duration-300 pointer-events-none whitespace-nowrap z-10">
            {skill.name}
            <!-- Arrow -->
            <div class="absolute top-full left-1/2 transform -translate-x-1/2 border-l-4 border-r-4 border-t-4 border-transparent border-t-gray-900"></div>
          </div>
        </div>
      ))}
    </div>

    <!-- Soft Skills Section -->
    <div class="mt-16 mb-8 text-center">
      <h3 class="text-2xl text-gray-800  font-stretch-expanded tracking-tighter mt-6 leading-relaxed">Soft skills</h3>
    </div>

    <!-- Soft Skills Row -->
    <div class="flex flex-wrap justify-center items-center gap-8 sm:gap-6 md:gap-8 max-w-5xl mx-auto mb-12">
      {softSkills.map((skill) => (
        <div class="relative flex flex-col items-center justify-center py-4 rounded-full bg-transparent border-gray-950 border-3 hover:border-gold-500 transition-all duration-300 hover:scale-110 shadow-lg hover:shadow-xl group lg:w-48 lg:h-24 w-full h-full">
          <div class="w-12 h-12 mb-1 flex items-center justify-center">
              <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" class="w-12 h-12" set:html={skill.icon}>
              </svg>
          </div>
          <span class="lg:text-xs text-base font-normal font-stretch-expanded text-center px-5">{skill.name}</span>
        </div>
      ))}
    </div>

    <!-- CTA Section -->
    <div class="bg-[#E3E2DC]/70 rounded-3xl shadow-lg hover:shadow-2xl transition-all duration-300 group relative overflow-hidden hover:bg-[#ebeae4] max-w-4xl mx-auto">
      <!-- Background Gradient -->
      <div class="absolute inset-0 bg-gradient-to-br from-transparent via-transparent to-gold-500/5 group-hover:to-gold-500/10 transition-all duration-300 border-3 rounded-3xl border-gray-950"></div>
      
      

  </div>
</section>